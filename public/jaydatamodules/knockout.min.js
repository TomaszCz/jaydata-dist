// JayData 1.5.13 
// Dual licensed under MIT and GPL v2
// Copyright JayStack Technologies (http://jaydata.org/licensing)
//
// JayData is a standards-based, cross-platform Javascript library and a set of
// practices to access and manipulate data from various online and offline sources.
//
// Credits:
//     Hajnalka Battancs, Dániel József, János Roden, László Horváth, Péter Nochta
//     Péter Zentai, Róbert Bónay, Szabolcs Czinege, Viktor Borza, Viktor Lázár,
//     Zoltán Gyebrovszki, Gábor Dolla
//
// More info: http://jaydata.org
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("jaydata/modules/knockout",["jaydata/core"],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.$data=e()}}(function(){return function(){function e(t,r,n){function o(a,s){if(!r[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){var r=t[a][1][e];return o(r||e)},l,l.exports,e,t,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}return e}()({1:[function(e,t,r){(function(n){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(r,"__esModule",{value:!0});var i=e("jaydata/core"),a=o(i),s="undefined"!=typeof window?window.ko:"undefined"!=typeof n?n.ko:null,u=o(s);!function(e){function t(t,i){for(var a={constructor:function(){var e=this;e.getEntity().propertyChanged.attach(function(t,n){o(e[n.propertyName],n.newValue)||e[n.propertyName](r(n.newValue))})},retrieveProperty:function(e){var t=this,i=e.name,a="_"+i;if(t[a])o(t[a],t.getEntity()[i])||t[a](r(t.getEntity()[i]));else{var s=t.getEntity()[i];s=r(s);var u=new e.type(s),p=t[a];u.subscribe(function(e){p=Array.isArray(e)?e.slice():e},null,"beforeChange"),u.subscribe(function(e){o(p,e)||t[a](r(e)),t.getEntity()[i]=n(e)}),t[a]=u}return t[a]},storeProperty:function(e,t){},equalityComparers:{type:u["default"].observable}},s=t.memberDefinitions.getPublicMappedProperties(),p=0,l=s.length;p<l;p++){var f=s[p].name;a[f]={type:s[p].type==Array?u["default"].observableArray:u["default"].observable},a.ValidationErrors={type:u["default"].observableArray}}e.Class.defineEx(i,[{type:e.KoObservableEntity,params:[new e.Class.ConstructorParameter(0),function(){return t}]}],null,a,{isWrappedType:function(e){return e===t}}),e.Container.registerConverter(i,t,function(e){return e},function(e){return"function"==typeof e.getEntity?e.getEntity():e})}Object.keys(e.Container.converters.to).forEach(function(t){var r=e.Container.converters.to[t]?e.Container.converters.to[t]["$data.Function"]||e.Container.converters.to[t]["default"]:void 0;e.Container.registerConverter(t,"$data.Function",function(n){return u["default"].isObservable(n)?n:r?r.apply(e.Container.converters[t],arguments):void i.Guard.raise(new i.Exception("Type Error","value is not koObservable",n))})});var r=function(t){return Array.isArray(t)?t.map(function(t){return t instanceof e.Entity?t.asKoObservable():t}):t instanceof e.Entity?t.asKoObservable():t},n=function d(e){return Array.isArray(e)?e.map(d):u["default"].isObservable(e)?(e=e.peek(),d(e)):(e&&"function"==typeof e.getEntity&&(e=e.getEntity()),e)},o=function(e,t){if(e=n(e),t=n(t),Array.isArray(t)){for(var r=!1,o=0;o<t.length;o++)if(e[o]!=t[o]){r=!0;break}if(e.length!=t.length&&(r=!0),r)return!1}else if(e!==t)return!1;return!0};if("undefined"!=typeof u["default"]){var a=function(t,r){if(t instanceof e.Expressions.ConstantExpression&&u["default"].isObservable(t.value)){r.some(function(e){e.observable===t.value&&(e.skipExecute=!0)}),r.push({observable:t.value,skipExecute:!1});var n=t.value();return i.Container.createConstantExpression(n,i.Container.getTypeName(n),t.name+"$Observable")}return t},s=e.Expressions.ParameterResolverVisitor.prototype.VisitProperty;e.Expressions.ParameterResolverVisitor.prototype.VisitProperty=function(e,t){var r=s.call(this,e,t);return this.resolvedObservables=this.resolvedObservables||[],a(r,this.resolvedObservables)};var p=e.Expressions.QueryExpressionCreator.prototype.VisitConstantExpression;e.Expressions.QueryExpressionCreator.prototype.VisitConstantExpression=function(e,t){return p&&(e=p.call(this,e,t)),a(e,this.resolvedObservables)};e.Expressions.QueryExpressionCreator.prototype.VisitCodeExpression;e.Expressions.QueryExpressionCreator.prototype.VisitCodeExpression=function(t,r){var n=t.source.toString(),o=i.Container.createCodeParser(this.scopeContext).createExpression(n);this.scopeContext.log({event:"JSCodeExpression",data:o});var a=i.Container.createConstantValueResolver(t.parameters,e.__global,this.scopeContext),s=i.Container.createParameterResolverVisitor();o=s.Visit(o,a),this.resolvedObservables=(this.resolvedObservables||[]).concat(s.resolvedObservables),this.scopeContext.log({event:"JSCodeExpressionResolved",data:o});var u=i.Container.createCodeToEntityConverter(this.scopeContext),p=u.Visit(o,{queryParameters:t.parameters,lambdaParameters:this.lambdaTypes,frameType:r.frameType}),l=i.Container.createParametricQueryExpression(p,u.parameters);return this.scopeContext.log({event:"EntityExpression",data:p}),l};var l=e.Expressions.QueryExpressionCreator.prototype.Visit;e.Expressions.QueryExpressionCreator.prototype.Visit=function(t,r){var n;if(t instanceof e.Expressions.FrameOperator){this.resolvedObservables=[];var n=l.call(this,t,r);n.observables=this.resolvedObservables,n.baseExpression=t}else n=l.call(this,t,r);return n};var f=e.EntityContext.prototype.executeQuery;e.EntityContext.prototype.executeQuery=function(e,t,r){var n=this,o=e.expression.observables;o&&o.length>0&&o.forEach(function(o){o&&o.observable.subscribe(function(){if(!o.skipExecute){var a=i.Container.createQueryExpressionCreator(n),s=a.Visit(e.expression.baseExpression);f.call(n,i.Container.createQueryable(e,s),t,r)}})}),f.call(n,e,t,r)},e.EntityWrapper.extend("$data.KoObservableEntity",{constructor:function(t,r){r&&r.isAssignableTo&&r.isAssignableTo(e.Entity)||i.Guard.raise(new i.Exception("Type: '"+r+"' is not assignable to $data.Entity"));var n;t instanceof r?n=t:t instanceof e.Entity?i.Guard.raise(new i.Exception("innerData is instance of '$data.Entity' instead of '"+r.fullName+"'")):n=new r(t),this._wrappedType=r,this.innerInstance=n},getEntity:function(){return this.innerInstance},updateEntity:function(t){var r;t instanceof this._wrappedType?r=t:t&&!(t instanceof e.Entity)&&t instanceof e.Object?r=t:i.Guard.raise("entity is an invalid object");for(var n=this._wrappedType.memberDefinitions.getPublicMappedProperties(),o=0;o<n.length;o++){var a=n[o];if(void 0!==r[a.name]){this[a.name](r[a.name]);var s=this.innerInstance.changedProperties.indexOf(a);s>=0&&this.innerInstance.changedProperties.splice(s,1)}}},getProperties:function(){var e=this,t=this.innerInstance.getType().memberDefinitions.getPublicMappedProperties(),r=t.map(function(t){return{type:t.type,name:t.name,owner:e,metadata:t,value:e[t.name]}});return r}}),e.Entity.prototype.asKoObservable=function(){var e=this.getType(),r=(e.namespace?e.namespace+".":"")+"Observable"+e.name;i.Container.isTypeRegistered(r)||t(e,r);var n=i.Container.resolveType(r);return n.isWrappedType(e)||(t(e,r),n=i.Container.resolveType(r)),new n(this)};var c=e.Queryable.prototype.toArray;e.Queryable.prototype.toArray=function(t,r){if(u["default"].isObservable(t)){if("undefined"!=typeof t.push){e.PromiseHandlerBase.createCallbackSettings();return this.toArray(function(r,n){t(r.map(function(t){return t instanceof e.Entity?t.asKoObservable():t}))},r)}return c.call(this,function(e,r){t(e)},r)}return c.call(this,t,r)}}else{var y=function(){i.Guard.raise(new i.Exception("Knockout js is required","Not Found!"))};e.Entity.prototype.asKoObservable=y}}(a["default"]),r["default"]=a["default"],t.exports=r["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"jaydata/core":"jaydata/core"}]},{},[1])(1)});
//# sourceMappingURL=knockout.min.js.map
